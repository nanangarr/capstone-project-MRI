(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[563],{475:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>b});var r=s(7876),t=s(4232),n=s(2577),i=s(1449),l=s(2671),d=s(5715),c=s(8230),m=s.n(c),o=s(1926),x=s(9099);function u(){let[e,a]=(0,t.useState)(!1),{logout:s}=(0,o.A)(),c=(0,x.useRouter)();return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("nav",{className:"fixed top-0 left-0 right-0 h-16 bg-white border-b z-50 px-4 flex items-center justify-between",children:[(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)(m(),{href:"/admin/dashboard",className:"flex items-center space-x-2",children:(0,r.jsx)("span",{className:"font-bold text-2xl text-primary ml-3",children:"MediPredict"})})}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(d.$,{variant:"ghost",size:"icon",className:"text-gray-600 hover:text-primary",children:(0,r.jsx)(n.A,{size:20})}),(0,r.jsx)(d.$,{variant:"ghost",size:"icon",className:"text-gray-600 hover:text-primary",children:(0,r.jsx)(i.A,{size:20})}),(0,r.jsx)("div",{className:"flex items-center ml-4 pl-4 border-l",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(d.$,{variant:"ghost",size:"icon",className:"text-gray-600 hover:text-primary",onClick:()=>{a(!e)},children:(0,r.jsx)("div",{className:"h-9 w-9 rounded-full bg-primary/10 flex items-center justify-center",children:(0,r.jsx)(l.A,{size:20,className:"text-primary"})})}),e&&(0,r.jsx)("div",{className:"absolute right-0 mt-2 w-48 bg-white border rounded shadow-md",children:(0,r.jsxs)("ul",{className:"space-y-1",children:[(0,r.jsx)("li",{children:(0,r.jsx)(m(),{href:"/admin/profile",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>a(!1),children:"Profil"})}),(0,r.jsx)("li",{children:(0,r.jsx)("div",{className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>{s(),c.push("/login"),a(!1)},children:"Logout"})})]})})]})})]})]})})}var p=s(8119),h=s(7396),g=s(395);function j(){let e=(0,x.useRouter)(),a=e.pathname,{logout:s}=(0,o.A)(),t=[{name:"Dashboard",path:"/admin/dashboard",icon:p.A},{name:"Data Users",path:"/admin/users",icon:h.A}];return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("aside",{className:"fixed top-16 left-0 h-[calc(100vh-4rem)] w-64 bg-white border-r z-40 overflow-y-auto flex flex-col justify-between",children:[(0,r.jsx)("div",{className:"flex flex-col p-2 gap-1 flex-grow",children:t.map(e=>(0,r.jsxs)(m(),{href:e.path,className:"flex items-center gap-3 px-3 py-2 rounded-md transition-colors ".concat(a.startsWith(e.path)?"bg-primary/10 text-primary font-medium":"hover:bg-gray-100 text-gray-700"),children:[e.icon&&(0,r.jsx)(e.icon,{size:20}),(0,r.jsx)("span",{children:e.name})]},e.name))}),(0,r.jsx)("div",{className:"p-2 border-t0",children:(0,r.jsxs)("button",{onClick:()=>{s(),e.push("/login")},className:"w-full flex items-center gap-3 px-3 py-2 rounded-md transition-colors ",children:[(0,r.jsx)(g.A,{size:20}),(0,r.jsx)("span",{className:"font-semibold",children:"Logout"})]})})]})})}function b(e){let{children:a}=e;return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)(u,{}),(0,r.jsx)(j,{}),(0,r.jsx)("main",{className:"pt-16 pl-64",children:(0,r.jsx)("div",{className:"p-6",children:a})})]})}},811:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>v});var r=s(7876),t=s(4232),n=s(9099),i=s(3397),l=s(5715),d=s(475),c=s(4433),m=s(7685),o=s(2885),x=s(7959),u=s(6739),p=s(1312),h=s(7897),g=s(2341),j=s(345),b=s(8230),f=s.n(b);function v(){let e=(0,n.useRouter)(),{nip:a}=e.query,[s,b]=(0,t.useState)(null),[v,y]=(0,t.useState)(!0),[N,w]=(0,t.useState)(!1),[k,A]=(0,t.useState)(null),[_,z]=(0,t.useState)(!1),[C,P]=(0,t.useState)({username:"",password:"",nama_lengkap:"",instansi:"",jabatan:"",email:"",isApproved:0});(0,t.useEffect)(()=>{if(!a)return void y(!1);(async()=>{try{y(!0),A(null);let e=await (0,c._u)(a);if(e)b(e),P({username:e.username||"",password:e.password||"",nama_lengkap:e.nama_lengkap||"",instansi:e.instansi||"",jabatan:e.jabatan||"",email:e.email||"",isApproved:e.isApproved||0});else throw Error("User data not found")}catch(e){console.error("Error in fetchUserData:",e),A(e.message||"Failed to load user data"),b(null)}finally{y(!1)}})()},[a]);let F=e=>{let{name:a,value:s}=e.target;P({...C,[a]:s})},R=async r=>{if(r.preventDefault(),!s)return void m.oR.error("User data not available");if(!a)return void m.oR.error("NIP is missing");if(!C.username.trim())return void m.oR.error("Username is required");try{w(!0),A(null);let s=await (0,c.rT)(a,{username:C.username,password:C.password.trim()?C.password:void 0,nama_lengkap:C.nama_lengkap,instansi:C.instansi,jabatan:C.jabatan,email:C.email,isApproved:1});console.log("API Response:",s),m.oR.success("Data user berhasil diperbarui"),setTimeout(()=>{e.push("/admin/users")},1500)}catch(a){console.error("Submit error:",a);let e=a.message||"Gagal mengubah data user";A(e),m.oR.error(e)}finally{w(!1)}},E=async()=>{if(a)try{y(!0),A(null);let e=await UserByNIP(a);b(e),P({username:e.username||"",password:"",nama_lengkap:e.nama_lengkap||"",instansi:e.instansi||"",jabatan:e.jabatan||"",email:e.email||"",isApproved:e.isApproved||0}),m.oR.success("Data berhasil dimuat ulang")}catch(e){A(e.message||"Failed to load user data"),m.oR.error(e.message||"Gagal memuat data")}finally{y(!1)}};return(0,r.jsxs)(d.default,{children:[(0,r.jsx)("div",{className:"mb-6 flex items-center justify-between",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(f(),{href:"/admin/users",children:(0,r.jsxs)(l.$,{variant:"outline",className:"gap-1",children:[(0,r.jsx)(o.A,{size:16}),"Kembali"]})}),(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"Edit User"})]})}),v?(0,r.jsxs)("div",{className:"flex justify-center items-center h-64",children:[(0,r.jsx)(x.A,{className:"animate-spin h-8 w-8 text-primary"}),(0,r.jsx)("span",{className:"ml-2 text-primary",children:"Loading user data..."})]}):k?(0,r.jsx)("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-6",children:(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(u.A,{className:"h-5 w-5 mr-2"}),(0,r.jsx)("p",{children:k})]}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsxs)(l.$,{onClick:E,variant:"outline",className:"flex items-center gap-2",children:[(0,r.jsx)(p.A,{size:16}),"Coba Lagi"]}),(0,r.jsxs)("p",{className:"mt-2 text-sm",children:["Jika masalah berlanjut, pastikan API server berjalan dan endpoint",(0,r.jsxs)("code",{className:"mx-1 px-1 bg-red-50 rounded",children:["/admin/users/",a]}),"sudah diimplementasikan."]})]})]})}):s?(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,r.jsx)("form",{onSubmit:R,className:"space-y-6",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-4 text-gray-700",children:"Informasi Dasar"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{htmlFor:"nama_lengkap",className:"block text-sm font-medium text-gray-700",children:"Nama Lengkap"}),(0,r.jsx)(i.p,{type:"text",id:"nama_lengkap",name:"nama_lengkap",value:C.nama_lengkap,onChange:F,className:"w-full"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{htmlFor:"nip",className:"block text-sm font-medium text-gray-700",children:"NIP"}),(0,r.jsx)(i.p,{type:"text",id:"nip",value:a,disabled:!0,className:"w-full bg-gray-100"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"NIP tidak dapat diubah"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{htmlFor:"instansi",className:"block text-sm font-medium text-gray-700",children:"Instansi"}),(0,r.jsx)(i.p,{type:"text",id:"instansi",name:"instansi",value:C.instansi,onChange:F,className:"w-full"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{htmlFor:"jabatan",className:"block text-sm font-medium text-gray-700",children:"Jabatan"}),(0,r.jsx)(i.p,{type:"text",id:"jabatan",name:"jabatan",value:C.jabatan,onChange:F,className:"w-full"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,r.jsx)(i.p,{type:"email",id:"email",name:"email",value:C.email,onChange:F,className:"w-full"})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-4 text-gray-700",children:"Kredensial Login"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700",children:"Username"}),(0,r.jsx)(i.p,{type:"text",id:"username",name:"username",value:C.username,onChange:F,required:!0,placeholder:"Masukkan username",className:"w-full"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Username akan digunakan untuk login"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(i.p,{type:_?"text":"password",id:"password",name:"password",value:C.password,onChange:F,placeholder:"Masukkan password",className:"w-full pr-10"}),(0,r.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600",onClick:()=>{z(!_)},children:_?(0,r.jsx)(h.A,{size:18}):(0,r.jsx)(g.A,{size:18})})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:C.password?"Edit password sesuai kebutuhan":"Masukkan password baru"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Status Pengguna"}),(0,r.jsxs)("div",{className:"mt-1",children:[1===C.isApproved?(0,r.jsx)("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs",children:"Aktif"}):(0,r.jsx)("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs",children:"Pending"}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Status akan otomatis diubah menjadi Aktif setelah menyimpan"})]})]}),(0,r.jsx)("div",{className:"pt-4",children:(0,r.jsx)(l.$,{type:"submit",className:"flex gap-2 bg-blue-600 hover:bg-blue-700 text-white w-full",disabled:N,children:N?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(x.A,{size:16,className:"animate-spin"}),(0,r.jsx)("span",{children:"Menyimpan..."})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(j.A,{size:16}),(0,r.jsx)("span",{children:"Simpan Perubahan"})]})})})]})]})})}):(0,r.jsxs)("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4",children:[(0,r.jsxs)("div",{className:"flex items-center mb-2",children:[(0,r.jsx)(u.A,{className:"h-5 w-5 mr-2"}),(0,r.jsx)("p",{className:"font-medium",children:"User tidak ditemukan"})]}),(0,r.jsxs)("p",{className:"text-sm",children:["NIP: ",a||"tidak tersedia"]}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsxs)(l.$,{onClick:E,variant:"outline",className:"flex items-center gap-2 mr-2",children:[(0,r.jsx)(p.A,{size:16}),"Coba Lagi"]})})]})]})}},3397:(e,a,s)=>{"use strict";s.d(a,{p:()=>n});var r=s(7876);s(4232);var t=s(8928);function n(e){let{className:a,type:s,...n}=e;return(0,r.jsx)("input",{type:s,"data-slot":"input",className:(0,t.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",a),...n})}},4433:(e,a,s)=>{"use strict";s.d(a,{_u:()=>l,a1:()=>i,kh:()=>t,rT:()=>d,wP:()=>n});var r=s(3004);let t=async()=>{try{return(await r.A.get("/admin/users")).data}catch(a){var e;throw(null==(e=a.response)?void 0:e.data)||{message:"An error occurred while fetching users"}}},n=async()=>{try{return(await r.A.get("/admin/users/pending")).data}catch(a){var e;throw(null==(e=a.response)?void 0:e.data)||{message:"An error occurred while fetching pending users"}}},i=async e=>{try{return(await r.A.delete("/admin/users/".concat(e))).data}catch(e){var a;throw console.error("Error removing user:",e),e.response&&(console.error("Response status:",e.response.status),console.error("Response data:",e.response.data)),(null==(a=e.response)?void 0:a.data)||{message:"An error occurred while removing user"}}},l=async e=>{try{return(await r.A.get("/admin/users/".concat(e))).data}catch(e){var a;throw(null==(a=e.response)?void 0:a.data)||{message:"An error occurred while approving user"}}},d=async(e,a)=>{try{return(await r.A.put("/admin/users/".concat(e),a)).data}catch(e){var s;throw(null==(s=e.response)?void 0:s.data)||{message:"An error occurred while updating user"}}}},6088:(e,a,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/users/edit/[nip]",function(){return s(811)}])}},e=>{var a=a=>e(e.s=a);e.O(0,[802,636,593,792],()=>a(6088)),_N_E=e.O()}]);